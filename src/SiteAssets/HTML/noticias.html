<!DOCTYPE html>
<html lang="en">

<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Document</title>
   <link rel="stylesheet" href="../SiteAssets/libs/bootstrap-5.1.3-dist/css/bootstrap.css">
   <script src="../SiteAssets/libs/jquery-3.6.0.js"></script>
   <script src="../SiteAssets/libs/bootstrap-5.1.3-dist/js/bootstrap.bundle.js"></script>
   <script src="../SiteAssets/libs/angular.js"></script>
   <script src="../SiteAssets/scripts/noticias.js"></script>

   <script>

      //1º Criação do módulo e definiçao do seu nome
      var app = angular.module("appNoticias", []);

      app.controller("controllerNoticias", function ($scope) {
         let select = '?$select=Title,DataPublicacao,TipoNoticia,LinkNoticia,ImagemNoticia,Localidade/Title,AutorNoticia/Title,Editor/Title, Modified';
         let expanded = '&$expand=Localidade,AutorNoticia,Editor'
         let order = '&$orderby=DataPublicacao desc';

         let query = select + expanded + order;

         getItems($scope, 'Notícias', query);
      })
   </script>
</head>

<body>
   <div class="container" ng-app="appNoticias">
      <div ng-controller="controllerNoticias">
         <div class="row">
            <div ng-repeat="noticia in items | orderBy: DataPublicacao : true" class="col">
               <div class="card" style="width: 18rem;">
                  <div ng-if="noticia.ImagemNoticia === null">
                     <img src="../SiteAssets/images/placeHolderNews.jpg" class="card-img-top" alt="Imagem Placeholder">
                  </div>
                  <div ng-if="noticia.ImagemNoticia !== null">
                     <img src="{{ noticia.ImagemNoticia.Url }}" class="card-img-top"
                        alt=".{{ noticia.ImagemNoticia.Url }}.">
                  </div>
                  <div class="card-body">
                     <h5 class="card-title">{{noticia.Title}}</h5>
                     <div class="card-text" ng-bind="formatarData('{{noticia.DataPublicacao}}')"></div>
                     <p class="card-text"> {{ noticia.Localidade.Title }} </p>
                     <p class="card-text"> {{ noticia.AutorNoticia.Title }} </p>
                     <p class="card-text"> Modificado por {{ noticia.Editor.Title}} em {{ noticia.Modified}} </p> 
                     <a href="{{noticia.LinkNoticia.Url}}" class="btn btn-primary">Link da Notícia</a>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</body>

</html>